---
title: ライフサイクル
date: '2023/02/04 19:00:00'
categories:
 - vue
---

マウント<div id="mount"></div>
-----------

Vueインスタンスを作成したら、そのインスタンスをHTML要素に紐付けることで、ブラウザ上でアプリケーションとして機能するようになります。

この紐付けることを**マウント**といいます。

Vueのインスタンスをマウントすると、指定したHTML要素はVueが生成するHTML要素に置き換わります。Vueインスタンスで定義した機能などは、マウントしたHTML要素とその子孫の要素でのみ使用可能です。

例えば、`<div id="app"></div>`にVueインスタンスをマウントした場合、`<div id="app"></div>`の内部でのみVueインスタンスで定義した機能を使用できます。

~~~HTML
<div id="app">
    <!--
        この中でのみVueインスタンスで定義した機能を使用できます
    -->
</div>
~~~

~~~javaScript
Vue.createApp({
    // ここにアプリケーションの機能を定義していきます
}).mount('#app')
~~~

`mount`メソッドに複数のHTML要素を特定できるようなセレクタを指定しても、「特定されたHTML要素の最初の要素にのみマウントされる」ことを注意してください。

~~~HTML
<div class="app"></div>
<!-- ↑↑↑　この要素にのみ、Vueインスタンスがマウントされます -->
<div class="app"></div>
<div class="app"></div>
<div class="app"></div>
<div class="app"></div>
~~~

もし複数のHTML要素にマウントする必要がある場合には、1つ1つマウントしてください。

また、マウントされるHTML要素は、Vueによって生成されたDOMに置き換わるので、Vueインスタンスのマウント前にイベントの付与やDOM操作を行うと、意図しない挙動になる可能性があるので注意しましょう。

dataで状態を定義する<div id="data"></div>
-----------------------

Vueインスタンス作成時に渡すオプションオブジェクトの`data`プロパティに、オブジェクトを返す関数を渡すことで`data`の状態を定義できます。

Vueで作成するアプリケーションは、この`data`を更新したり、加工して表示したりすることが基本になります。

Vueインスタンス作成時に渡すアプリケーションオブジェクトのdataプロパティには、オブジェクトを返す関数のみ指定できます。

~~~javaScript
Vue.createApp({
    data: function() {
        return {
            message: 'ToDoアプリケーション',
        }
    },
}).mount('#app')
~~~

このように、dataプロパティにオブジェクトまたはオブジェクトを返す関数を渡してあげると、Vueアプリケーションはそのオブジェクトのプロパティが、アクセスまたは変更されることを検知します。これにより、dataで定義した状態を変更すると自動的に表示を変更したりすることが可能となります。

Mustache記法で状態を表示<div id="mustache"></div>
------------------------------

Vueアプリケーションのdataプロパティで指定したオブジェクトの値を表示するには、{{と}}でキー(message)を括ります。これを**Mustache記法**と呼びます。

~~~HTML
<div id="app">{{ message }}</div>
~~~

VueインスタンスはマウントしたHTML要素とその子孫の要素にVueの機能が使用できるので、例えば`<p>`で囲むなどが可能となります。
~~~HTML
<div id="app">
    <p>{{ message }}</p>
</div>
~~~

Mustache記法で表示するテキストはHTMLそのものを出力することはできます。

ライフサイクル<div id="liftCycle"></div>
----------------

Vueのインスタンスの作成時やDOMへの反映時など、一連の挙動の過程の中の何らかのタイミングで処理は実行されます。この一連の過程のことを「ライフサイクル」、そして処理を実行させるタイミングのことを「ライフサイクルフック」と呼びます。

Vueインスタンスを作成する際、オプションオブジェクトのライフサイクルフックのプロパティに関数を登録すると、自動でその関数が実行されます。

| ライフサイクルフック名 | タイミング |
| :------------ | :--------------- |
| beforeCreate | インスタンスの生成時に実行。<br/>データの参照などはできない |
| created | インスタンスが生成され、データが初期化された後に実行。<br/>データの参照が可能 |
| beforeMount | インスタンスがDOMにマウントされる前に実行。<br/>DOMの参照はできない |
| mounted | インスタンスがDOMにマウントされた後に実行。<br/>DOMの参照が可能 |
| beforeUpdate | データが更新され、DOMに反映される前に実行 |
| updated | データが更新され、DOMに反映された後に実行 |
| beforeUnmount | インスタンスのマウントが解除される直前に実行 |
| unmounted | インスタンスのマウントが解除された後に実行 |

![ライフサイクルフック](https://v3.ja.vuejs.org/images/lifecycle.svg)

`created`はデータにアクセスすることができるようになるので、例えば外部からデータを取得しVueインスタンス内のデータに格納するなどの使い方ができます。

`mounted`はVueが生成するDOMにアクセスできるので、このタイミングで直接DOMを操作するライブラリと組み合わせて使用可能です。




